import os ;
import slice ;
import testing ;

using gcc : : [ os.environ CXX ] ;
using pkg-config ;
import pkg-config ;

variant coverage : debug ;

project
  : requirements
			<define>ICE_CPP11_MAPPING
			<cxxstd>17
			<visibility>hidden
			<linkflags>"-Wl,-z,defs,--warn-once,--gc-sections"
			<variant>release:<cxxflags>"-flto"
			<toolset>gcc:<variant>release:<cxxflags>"-flto=2"
			<variant>release:<linkflags>"-flto"
			<toolset>gcc:<variant>release:<linkflags>"-flto=2"
			<variant>debug:<warnings>extra
			<variant>debug:<warnings-as-errors>on
			<variant>coverage:<coverage>on
			<toolset>tidy:<checkxx>boost-*
			<toolset>tidy:<checkxx>bugprone-*
			<toolset>tidy:<xcheckxx>bugprone-macro-parentheses
			<toolset>tidy:<checkxx>clang-*
			<toolset>tidy:<xcheckxx>clang-analyzer-cplusplus.NewDeleteLeaks
			<toolset>tidy:<checkxx>misc-*
			<toolset>tidy:<xcheckxx>misc-non-private-member-variables-in-classes
			<toolset>tidy:<checkxx>modernize-*
			<toolset>tidy:<xcheckxx>modernize-use-trailing-return-type
			<toolset>tidy:<checkxx>hicpp-*
			<toolset>tidy:<xcheckxx>hicpp-no-array-decay
			<toolset>tidy:<xcheckxx>hicpp-vararg
			<toolset>tidy:<checkxx>performance-*
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/classes.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/classtype.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/collections.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/enums.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/functions.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/inheritance.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/interfaces.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/json.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/locals.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/optionals.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/structs.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/types.h
			<toolset>tidy:<exclude>test/bin/tidy/debug/checker-none/cxxstd-17-iso/xml.h
			<toolset>tidy:<exclude>slicer/bin/common.h
			<toolset>tidy:<exclude>xml/bin/tidy/debug/checker-none/cxxstd-17-iso/xmlExceptions.h
			<toolset>tidy:<exclude>db/bin/tidy/debug/checker-none/cxxstd-17-iso/sqlExceptions.h
			<toolset>tidy:<exclude>db/bin/tidy/debug/checker-none/cxxstd-17-iso/testModels.h
			<toolset>tidy:<exclude>ice/cpp/*
			<toolset>tidy:<define>ICE_IGNORE_VERSION
			<toolset>tidy:<define>__x86_64
			;

build-project slicer ;

pkg-config.import libxmlpp : : <name>libxml++-3.0 ;
pkg-config.import glibmm : : <name>glibmm-2.4 ;

